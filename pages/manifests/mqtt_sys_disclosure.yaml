id: mqtt_sys_disclosure
version: 0.1.1
type: abi
description: |
  Checks if subscribing to # also receives $SYS topics, which can leak system
  information (connections, topics, etc.) to attackers with client access.

build:
  system: cmake
  platforms: [linux-amd64]

abi:
  api: v1
  symbol: kraken_run

runtime:
  protocol: mqtt
  timeout: 30s
  memory: 64m

findings:
  - id: MQTT-SYS-DISCLOSURE
    severity: high
    description: Sensitive information exposed via $SYS topics
